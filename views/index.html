<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FORECAST DE VENDAS</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="/css/logistica.css?v=1743796395893">
</head>

<body>
  <div class="container">
    <div class="header">
      <header class="header-container">
        <div class="header-left">
          <div class="header-logo">
            <a href="/capa">
              <img class="img_link" src="/images/logo-nexo-sem-fundo.png" alt="Imagem Nexo" title="Voltar para Home">
            </a>
          </div>
          <h3 class="header-title">Forecast de Vendas</h3>
        </div>
      </header>
    </div>

    <div class="sairExcel">
      <button id="logoutButton1">Sair</button>
      <img class="img_link_excel" src="/images/excel.png"   alt="Exportar Excel" id="btnExportExcel" title="Exportar tabela">
      <img class="img_link_excel" src="/images/export.png"  alt="Importar Excel" id="btnImportExcel" title="Importar tabela">
      <input type="file" id="fileImportExcel" accept=".xlsx,.xls" style="display:none">
      <img class="img_link_excel" src="/images/diskette.png" alt="Salvar Dados" id="btnSave" title="Salvar dados">
      <img class="img_link_excel" src="/images/clean.png"    alt="Limpar Dados" id="btnClean" title="Limpar tabela">
    </div>

    <div id="feedback1" style="display:none; text-align:center; font-weight:bold; margin:10px; color:red;"></div>

    <div id="filters">
      <div class="menu-toggle">
        <button id="menuToggle" class="menu-button">
          <span class="menu-icon">☰</span> Filtros
        </button>
      </div>

      <div class="filter-container" id="filterContainer">
        <div class="filter-inputs">
          <div class="filter-row filter-row-top">
            <div class="filter-item">
              <label for="representanteFilter1">Representante:</label>
              <input type="text" id="representanteFilter1" placeholder="Ex.: P7, NDR, NCOLLOR">
            </div>

            <div class="filter-item">
              <label for="clienteFilter1">Cliente:</label>
              <input type="text" id="clienteFilter1" placeholder="Ex.: 3M, ADITIVE PLASTICOS">
            </div>

            <div class="filter-item">
              <label for="cnpjFilter1">CNPJ:</label>
              <input type="text" id="cnpjFilter1" inputmode="numeric" placeholder="Somente números, ex.: 08712676000110">
            </div>

          </div>
        </div>
        <div class="filter-buttons">
          <button id="applyFilters1">Aplicar Filtros</button>
          <button id="clearFilters1">Limpar Filtros</button>
          <button id="btnAddRow" title="Adicionar uma nova linha">+ Adicionar linha</button>
        </div>
      </div>
    </div>

    <div id="grandTotal" class="grand-total"></div>

    <div class="table-container">
      <table id="order-table1">
        <thead>
          </thead>
        <tbody></tbody>
      </table>
    </div>

    <div id="lastModInfo"></div>
  </div>
  
  <script src="/logistica02.js?v=1743796395893"></script>

  <script>
    async function logoutUser() {
      try {
        const res = await fetch('/api/logout', { method: 'POST', credentials: 'include' });
        if (res.ok) window.location.href = '/login2';
        else alert('Erro ao sair. Tente novamente.');
      } catch (err) {
        console.error('Erro no logout:', err);
        alert('Erro de conexão ao sair.');
      }
    }
    document.getElementById('logoutButton1').addEventListener('click', logoutUser);

    // Menu toggle logic (mobile)
    const menuToggle = document.getElementById('menuToggle');
    const filterContainer = document.getElementById('filterContainer');
    if(menuToggle && filterContainer){
      menuToggle.addEventListener('click', () => {
        if (filterContainer.style.display === 'flex') {
          filterContainer.classList.add('closing');
          filterContainer.addEventListener('animationend', () => {
             filterContainer.style.display = 'none';
             filterContainer.classList.remove('closing');
             filterContainer.classList.remove('active');
          }, { once: true });
        } else {
          filterContainer.style.display = 'flex';
          filterContainer.classList.add('active');
        }
      });
    }
  </script>
</body>
</html>